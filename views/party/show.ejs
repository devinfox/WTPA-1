<%- include('./../_partials/header') %>
<div class="backdiv">
<a class="btn btn-warning" href='/'>Add More to Your Itinerary</a> <br> 
</div>
<br>

<!-- container to hold all itinerary stops -->
<div class="container">
<table class="col-xs-12 col-sm-11 col-md-10">
    
<% if (stops) {%>
    <% stops.forEach(function(stop, idx) { %>
        <tr class="itin">
            <!--will up down arrows -->
            <td style="border: 1px solid black; padding: 0 5px 0 5px">
                 <% if (user) { %>   
                    <% if (idx == 0) { %>
                    <span><i class="dead fa fa-3x fa-arrow-circle-up" aria-hidden="true"></i></span>
                    <a href="/party/move?dir=d&id=<%=stop.id%>">
                        <i class="downArrow fa fa-3x fa-arrow-circle-down" aria-hidden="true"></i>
                    </a>
                    <% } else if (idx < stops.length -1) { %>
                    <a href="/party/move?dir=u&id=<%=stop.id%>">
                        <i class="fa fa-3x fa-arrow-circle-up" aria-hidden="true"></i>
                    </a>
                    <a href="/party/move?dir=d&id=<%=stop.id%>">
                        <i class="downArrow fa fa-3x fa-arrow-circle-down" aria-hidden="true"></i>
                    </a>
                    <% } else { %>
                    <a href="/party/move?dir=u&id=<%=stop.id%>">
                        <i class="fa fa-3x fa-arrow-circle-up" aria-hidden="true"></i>
                    </a>
                    <span><i class="dead fa fa-3x fa-arrow-circle-down" aria-hidden="true"></i></span>
                    <% } %>
                <% } %>
            </td>
            <!-- holds stop data -->
            <td style="border: 1px solid black">
            Name: <%= stop.name %><br>
            Location: <%= stop.location %><br>
            Time: <%= stop.time %>
            </td>
            <td style="border: 1px solid black">
                <% if (user) { %>
                    <% if (user.id === pageId) { %>
                        <form action='/party/<%= pageId %>?_method=DELETE' method='POST'>
                            <input type='hidden' value='<%=stop.id%>' name="stop_id">
                            <button class="btn btn-danger btn-sm">remove</button>
                        </form>
                    <% } %>
                <% } %>
                            
                <button class="btn btn-info btn-sm"><a style="color: white;" href="<%= stop.yelpUrl %>" target="blank" class="yelp"><i class="fa fa-yelp" aria-hidden="true"></i>To Yelp</a><br></button>
            </td>  
        </tr>
    <% }); %>
    <% } %>
</table>

<!-- clears party -->
<div class="btnholder">
    <% if (stops && stops.length) { %>
        <form action="/party/all?_method=DELETE" method="POST">
            <button type="submit" class="btn btn-danger">Clear Party</button>
        </form>
    <% } %><br><br>

    <!-- comments go here -->
    <form action="/party/comment" method="POST">
        <input type="text" name="text" class="form-control" placeholder="add comment..."><br>
        <input type="text" name="name" class="form-control" placeholder="who?"><br>
        <button type="submit" class="btn btn-danger">add comment</button>
    </form><br>

    <h4 class="itin" style="color: red;">Comments:</h4>

    <table class="col-xs-12 col-sm-11 col-md-10">
        <% userPage.comments.forEach(comment => { %>
            <tr class="itin">
                <td><%= comment.text %></td>
                <td><%= comment.name %></td>
                <td>
                <form action='/party/out?_method=DELETE' method='POST'>
                    <input type='hidden' value='<%=comment.id%>' name="comment_id">
                    <button class="btn btn-danger btn-sm">remove comment</button>
                </form>
            </td>
            </tr>
            <% }) %>
    </table>
</div>
</div>


<%- include('./../_partials/footer') %>